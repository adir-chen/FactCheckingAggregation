{% extends 'claims/layout.html' %}

{% block page_content %}
    <div id="contact_us_page" style="max-width: 900px; margin: auto; min-height: 750px; padding: 40px 0;">
        <h4>How can we help?</h4>
        <br>
        <div class="claim_box" style="width: 100%; padding: 20px 40px 20px 20px; min-height: 400px;">
            {% csrf_token %}
            <p id="error_msg" style="color: red; font-size: 12px;" hidden> </p>
            <p id="success_msg" style="color: dodgerblue; font-size: 12px;" hidden>Your message has been sent successfully </p>
            <h5>Mail Details:</h5>
            <input id="user_email" type="text" placeholder="Your e-mail" style="width: 50%; margin: 10px;"><br>
            <input id="subject" type="text" placeholder="Subject" style="width: 50%; margin: 10px;"><br>
            <br>
            <h5>Message Details:</h5>
            <textarea id="description" placeholder="Description" style="width: 100%; height: 100px; margin: 10px;"></textarea><br>
            <button id="submit_email" type="submit" class="btn btn-info" style="margin: 10px 0;">Send email</button>
        </div>
    </div>

    <script>
    $("#submit_email").click(function(e){
        {#e.preventDefault();#}
        $.ajax({
            type: 'POST',
            url: "{% url 'contact_us:send_email' %}",
            headers: { "X-CSRFToken": getCookie('csrftoken')},
            data: {
                user_email: $("#user_email").val(),
                subject: $("#subject").val(),
                description: $("#description").val()
            },
            success: function (request) {
                $("#user_email").val('');
                $("#subject").val('');
                $("#description").val('');
                $("#success_msg").attr("hidden", false);

            },
            error: function (error) {
                let err = error.responseText.split('\n')[1];
                document.getElementById("error_msg").innerHTML =
                    '* Error:  ' + err.toLowerCase() + ' *';
                $("#error_msg").attr("hidden", false);
            }
        });
    });

    function getCookie(c_name) {
        if (document.cookie.length > 0) {
            c_start = document.cookie.indexOf(c_name + "=");
            if (c_start != -1) {
                c_start = c_start + c_name.length + 1;
                c_end = document.cookie.indexOf(";", c_start);
                if (c_end == -1) c_end = document.cookie.length;
                return unescape(document.cookie.substring(c_start, c_end));
            }
        }
        return "";
    }
</script>
{% endblock %}

{% block claim_head_title %}
    FactCheckProject | Contact us
{% endblock %}